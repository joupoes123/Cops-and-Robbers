steps:
  - label: ":lua: Lint Code"
    command: "luacheck ."
    plugins:
      # This tells Buildkite to run the command inside a Docker container
      - docker#v5.9.0:
          # Use a public Docker image that has luacheck pre-installed
          image: "lua-check/lua-check:latest"
    soft_fail: true

  - label: ":package: Package Resource Artifacts"
    command: "buildkite-agent artifact upload '**/*'"

  - wait

  - block: "Deploy to Server?"
    if: build.branch == "main"

  - label: ":rocket: Deploy"
    if: build.branch == "main"
    command: "./scripts/deploy.sh"